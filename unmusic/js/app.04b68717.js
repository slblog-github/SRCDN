(function(t){function e(e){for(var r,i,s=e[0],c=e[1],l=e[2],d=0,f=[];d<s.length;d++)i=s[d],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&f.push(n[i][0]),n[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);u&&u(e);while(f.length)f.shift()();return o.push.apply(o,l||[]),a()}function a(){for(var t,e=0;e<o.length;e++){for(var a=o[e],r=!0,s=1;s<a.length;s++){var c=a[s];0!==n[c]&&(r=!1)}r&&(o.splice(e--,1),t=i(i.s=a[0]))}return t}var r={},n={app:0},o=[];function i(e){if(r[e])return r[e].exports;var a=r[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=t,i.c=r,i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(a,r,function(e){return t[e]}.bind(null,r));return a},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var u=c;o.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"002f":function(t,e,a){"use strict";a.r(e),a.d(e,"Decrypt",(function(){return l}));a("e260"),a("fb6a"),a("ace4"),a("e6cf"),a("5cc6"),a("b39a"),a("ddb0"),a("2b3d");var r=a("06dc"),n=a("fd2f");const o=a("cb96"),i=[105,102,109,116],s=[254,254,254,254],c={" WAV":".wav",FLAC:".flac"," MP3":".mp3"," A4M":".m4a"};async function l(t,e,a){const l=new Uint8Array(await Object(r["d"])(t));if(!Object(r["h"])(i,l.slice(0,4))||!Object(r["h"])(s,l.slice(8,12)))return"xm"===a?{status:!1,message:"此xm文件已损坏"}:await Object(n["Decrypt"])(t,e,a,!0);let u=(new TextDecoder).decode(l.slice(4,8));if(!c.hasOwnProperty(u))return{status:!1,message:"未知的xm文件类型"};let d=l[15],f=l[12]|l[13]<<8,m=l.slice(16),h=m.length;for(let r=f;r<h;++r)m[r]=m[r]-d^255;const p=Object(r["b"])(m,"mp3"),b=r["a"][p];let g=new Blob([m],{type:b});const w=await o.parseBlob(g);"wav"===p&&(w.common.album="",w.common.artist="",w.common.title="");const y=Object(r["e"])(w.common.artist,w.common.title,e,"_"),v=Object(r["f"])(w);return{status:!0,title:y.title,artist:y.artist,ext:p,album:w.common.album,picture:v,file:URL.createObjectURL(g),mime:b,rawExt:"xm"}}},"034f":function(t,e,a){"use strict";var r=a("85ec"),n=a.n(r);n.a},"06dc":function(t,e,a){"use strict";a.d(e,"c",(function(){return n})),a.d(e,"i",(function(){return i})),a.d(e,"a",(function(){return u})),a.d(e,"d",(function(){return d})),a.d(e,"e",(function(){return f})),a.d(e,"f",(function(){return m})),a.d(e,"h",(function(){return h})),a.d(e,"b",(function(){return p})),a.d(e,"g",(function(){return b})),a.d(e,"k",(function(){return g})),a.d(e,"j",(function(){return w}));a("e260"),a("fb6a"),a("e6cf"),a("1276"),a("2ca0"),a("498a"),a("ddb0"),a("2b3d");const r=a("7907"),n=[102,76,97,67],o=[73,68,51],i=[79,103,103,83],s=[102,116,121,112],c=[48,38,178,117,142,102,207,17,166,217,0,170,0,98,206,108],l=[82,73,70,70],u={mp3:"audio/mpeg",flac:"audio/flac",m4a:"audio/mp4",ogg:"audio/ogg",wma:"audio/x-ms-wma",wav:"audio/x-wav"};async function d(t){return await new Promise(e=>{const a=new FileReader;a.onload=t=>{e(t.target.result)},a.readAsArrayBuffer(t)})}function f(t,e,a,r="-"){let n="",o="",i=a.split(r);return i.length>1?(n=i[0].trim(),o=i[1].trim()):1===i.length&&(o=i[0].trim()),"string"==typeof t&&""!==t&&(n=t),"string"==typeof e&&""!==e&&(o=e),{artist:n,title:o}}function m(t){let e="";if(void 0!==t.common.picture&&t.common.picture.length>0){let a=new Blob([t.common.picture[0].data],{type:t.common.picture[0].format});e=URL.createObjectURL(a)}return e}function h(t,e){return t.every((t,a)=>t===e[a])}function p(t,e){return h(o,t.slice(0,o.length))?"mp3":h(n,t.slice(0,n.length))?"flac":h(i,t.slice(0,i.length))?"ogg":h(s,t.slice(4,4+s.length))?"m4a":h(c,t.slice(0,c.length))?"wma":h(l,t.slice(0,l.length))?"wav":e}async function b(t){try{let e=await fetch(t),a=e.headers.get("Content-Type");if(a.startsWith("image/")){let t=await e.arrayBuffer(),r=new Blob([t],{type:a}),n=URL.createObjectURL(r);return{buffer:t,url:n,type:a}}}catch(e){}return{buffer:null,url:"",type:""}}async function g(t,e,a,n,o=null,i="Cover"){const s=new r(t);return s.setFrame("TPE1",e).setFrame("TIT2",a).setFrame("TALB",n),null!==o&&s.setFrame("APIC",{type:3,data:o,description:i}),s.addTag(),s.arrayBuffer}function w(t,e="callback"){return new Promise((a,r)=>{let n;window[e]=function(t){delete window[e],n.parentNode&&n.parentNode.removeChild(n),a(t)},n=document.createElement("script"),n.type="text/javascript",n.src=t,n.addEventListener("error",t=>{r(t)}),document.head.appendChild(n)})}},1:function(t,e){},2:function(t,e){},3:function(t,e){},4:function(t,e){},"56d7":function(t,e,a){"use strict";a.r(e);a("46a1"),a("450d");var r=a("e5f2"),n=a.n(r),o=(a("6b30"),a("c284")),i=a.n(o),s=(a("0c67"),a("299c")),c=a.n(s),l=(a("b5d8"),a("f494")),u=a.n(l),d=(a("560b"),a("dcdc")),f=a.n(d),m=(a("f225"),a("89a9")),h=a.n(m),p=(a("f4f9"),a("c2cc")),b=a.n(p),g=(a("7a0f"),a("0f6c")),w=a.n(g),y=(a("aaa5"),a("a578")),v=a.n(y),_=(a("adec"),a("3d2d")),k=a.n(_),x=(a("bdc7"),a("aa2f")),j=a.n(x),O=(a("de31"),a("c69e")),M=a.n(O),D=(a("5466"),a("ecdf")),A=a.n(D),U=(a("38a0"),a("ad41")),S=a.n(U),C=(a("1951"),a("eedf")),E=a.n(C),B=(a("acb6"),a("c673")),P=a.n(B),L=(a("fd71"),a("a447")),T=a.n(L),F=a("2b0e"),q=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-container",{attrs:{id:"app"}},[a("el-main",[a("x-upload",{on:{handle_error:t.showFail,handle_finish:t.showSuccess}}),a("div",{attrs:{id:"app-control"}},[a("el-row",{staticStyle:{"padding-bottom":"1em","font-size":"14px"}},[t._v(" 歌曲命名格式： "),a("el-radio",{attrs:{label:"1",name:"format"},model:{value:t.download_format,callback:function(e){t.download_format=e},expression:"download_format"}},[t._v("歌手-歌曲名")]),a("el-radio",{attrs:{label:"2",name:"format"},model:{value:t.download_format,callback:function(e){t.download_format=e},expression:"download_format"}},[t._v("歌曲名")]),a("el-radio",{attrs:{label:"3",name:"format"},model:{value:t.download_format,callback:function(e){t.download_format=e},expression:"download_format"}},[t._v("歌曲名-歌手")]),a("el-radio",{attrs:{label:"4",name:"format"},model:{value:t.download_format,callback:function(e){t.download_format=e},expression:"download_format"}},[t._v("同原文件名")])],1),a("el-row",[a("el-button",{attrs:{icon:"el-icon-download",plain:""},on:{click:t.handleDownloadAll}},[t._v("下载全部")]),a("el-button",{attrs:{icon:"el-icon-delete",plain:"",type:"danger"},on:{click:t.handleDeleteAll}},[t._v("清除全部")]),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"top-start"}},[a("div",{attrs:{slot:"content"},slot:"content"},[t._v(" 当您使用此工具进行大量文件解锁的时候，建议开启此选项。"),a("br"),t._v(" 开启后，解锁结果将不会存留于浏览器中，防止内存不足。 ")]),a("el-checkbox",{staticStyle:{"margin-left":"1em"},attrs:{border:""},model:{value:t.instant_download,callback:function(e){t.instant_download=e},expression:"instant_download"}},[t._v("立即保存")])],1)],1)],1),a("audio",{attrs:{autoplay:t.playing_auto,src:t.playing_url,controls:""}}),a("x-preview",{attrs:{download_format:t.download_format,"table-data":t.tableData},on:{music_changed:t.changePlaying}})],1),a("el-footer",{attrs:{id:"app-footer"}},[a("el-row",[a("a",{attrs:{href:"https://github.com/ix64/unlock-music",target:"_blank"}},[t._v("音乐解锁")]),t._v("(v"),a("span",{domProps:{textContent:t._s(t.version)}}),t._v(")：移除已购音乐的加密保护。 "),a("a",{attrs:{href:"https://github.com/ix64/unlock-music/wiki/使用提示",target:"_blank"}},[t._v("使用提示")])]),a("el-row",[t._v(" 目前支持网易云音乐(ncm), QQ音乐(qmc, mflac, mgg), 虾米音乐(xm), 酷我音乐(.kwm) "),a("a",{attrs:{href:"https://github.com/ix64/unlock-music/blob/master/README.md",target:"_blank"}},[t._v("更多")]),t._v("。 ")]),a("el-row",[a("span",[t._v("Copyright © 2019-")]),a("span",{domProps:{textContent:t._s((new Date).getFullYear())}}),t._v(" MengYX 音乐解锁使用 "),a("a",{attrs:{href:"https://github.com/ix64/unlock-music/blob/master/LICENSE",target:"_blank"}},[t._v("MIT许可协议")]),t._v(" 开放源代码 ")])],1)],1)},R=[],I=(a("e6cf"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-upload",{attrs:{"auto-upload":!1,"on-change":t.handleFile,"show-file-list":!1,action:"",drag:"",multiple:""}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),a("em",[t._v("点击选择")])]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("本工具仅在浏览器内对文件进行解锁，无需消耗流量")]),a("transition",{attrs:{name:"el-fade-in"}},[a("el-progress",{directives:[{name:"show",rawName:"v-show",value:t.progress_show,expression:"progress_show"}],staticStyle:{margin:"16px 6px 0 6px"},attrs:{format:t.progressFormat,percentage:t.progress_percent,"stroke-width":16,"text-inside":!0}})],1)],1)}),N=[],$={name:"upload",data(){return{cacheQueue:[],workers:[],idle_workers:[],thread_num:1,progress_show:!1,progress_finished:0,progress_all:0,progress_percent:0}},mounted(){if(""!==document.location.host){this.thread_num=navigator.hardwareConcurrency||1;const t=a("bfa2");this.workers.push(t().CommonDecrypt),this.idle_workers.push(0),setTimeout(()=>{for(let e=1;e<this.thread_num;e++)this.workers.push(t().CommonDecrypt),this.idle_workers.push(e)},1e3)}else{const t=a("bd2e");this.workers.push(t.CommonDecrypt),this.idle_workers.push(0)}},methods:{progressFormat(){return this.progress_finished+"/"+this.progress_all},progressChange(t,e){this.progress_all+=e,this.progress_finished+=t,this.progress_percent=Math.round(this.progress_finished/this.progress_all*100),this.progress_finished===this.progress_all?setTimeout(()=>{this.progress_show=!1,this.progress_finished=0,this.progress_all=0},3e3):this.progress_show=!0},handleFile(t){this.progressChange(0,1),this.idle_workers.length>0?this.handleDoFile(t,this.idle_workers.shift()):this.cacheQueue.push(t)},handleCacheQueue(t){0!==this.cacheQueue.length?this.handleDoFile(this.cacheQueue.shift(),t):this.idle_workers.push(t)},handleDoFile(t,e){this.workers[e](t).then(t=>{this.$emit("handle_finish",t),this.handleCacheQueue(e),this.progressChange(1,0)}).catch(a=>{this.$emit("handle_error",a,t.name),this.handleCacheQueue(e),this.progressChange(1,0)})}}},Q=$,J=(a("f1ab"),a("2877")),W=Object(J["a"])(Q,I,N,!1,null,"6b3795fe",null),H=W.exports,V=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData}},[a("el-table-column",{attrs:{label:"封面"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:e.row.picture}},[a("div",{staticClass:"image-slot el-image__error",attrs:{slot:"error"},slot:"error"},[t._v(" 暂无封面 ")])])]}}])}),a("el-table-column",{attrs:{label:"歌曲"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(e.row.title))])]}}])}),a("el-table-column",{attrs:{label:"歌手"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",[t._v(t._s(e.row.artist))])]}}])}),a("el-table-column",{attrs:{label:"专辑"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",[t._v(t._s(e.row.album))])]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{circle:"",icon:"el-icon-video-play",type:"success"},on:{click:function(a){return t.handlePlay(e.$index,e.row)}}}),a("el-button",{attrs:{circle:"",icon:"el-icon-download"},on:{click:function(a){return t.handleDownload(e.row)}}}),a("el-button",{attrs:{circle:"",icon:"el-icon-delete",type:"danger"},on:{click:function(a){return t.handleDelete(e.$index,e.row)}}})]}}])})],1)},z=[];a("a434"),a("e260"),a("2ca0"),a("ddb0"),a("2b3d");function K(t,e){const a=document.createElement("a");switch(a.href=t.file,e){default:case"1":a.download=t.artist+" - "+t.title+"."+t.ext;break;case"2":a.download=t.title+"."+t.ext;break;case"3":a.download=t.title+" - "+t.artist+"."+t.ext;break;case"4":a.download=t.rawFilename+"."+t.ext;break}document.body.append(a),a.click(),a.remove()}function Y(t){URL.revokeObjectURL(t.file),t.picture.startsWith("blob:")&&URL.revokeObjectURL(t.picture)}var G={name:"preview",props:{tableData:{type:Array,required:!0},download_format:{type:String,required:!0}},methods:{handlePlay(t,e){this.$emit("music_changed",e.file)},handleDelete(t,e){Y(e),this.tableData.splice(t,1)},handleDownload(t){K(t,this.download_format)}}},X=G,Z=Object(J["a"])(X,V,z,!1,null,"6856848d",null),tt=Z.exports,et=a("9224"),at={name:"app",components:{xUpload:H,xPreview:tt},data(){return{version:et.version,activeIndex:"1",tableData:[],playing_url:"",playing_auto:!1,download_format:"1",instant_download:!1}},created(){this.$nextTick((function(){this.finishLoad()}))},methods:{async finishLoad(){const t=document.getElementById("loader-mask");let e;t&&t.remove();try{const t=await fetch("https://stats.ixarea.com/collect/music/app-version",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({Version:this.version})});e=await t.json()}catch(a){}e&&(e.HttpsFound||e.Found&&"https:"!==window.location.protocol)?this.$notify.warning({title:"发现更新",message:"发现新版本 v"+e.Version+"<br/>更新详情："+e.Detail+'<br/><a target="_blank" href="'+e.URL+'">获取更新</a>',dangerouslyUseHTMLString:!0,duration:15e3,position:"top-left"}):this.$notify.info({title:"离线使用",message:"我们使用PWA技术，无网络也能使用<br/>最近更新："+et.updateInfo+'<br/><a target="_blank" href="https://github.com/ix64/unlock-music/wiki/使用提示">使用提示</a>',dangerouslyUseHTMLString:!0,duration:1e4,position:"top-left"})},showSuccess(t){if(t.status){this.instant_download?(K(t,this.download_format),Y(t)):(this.tableData.push(t),this.$notify.success({title:"解锁成功",message:"成功解锁 "+t.title,duration:3e3}));{let e=[t.title,t.artist,t.album];window._paq.push(["trackEvent","Unlock",t.rawExt+","+t.mime,JSON.stringify(e)])}}else this.showFail(t.message,t.rawFilename+"."+t.rawExt)},showFail(t,e){this.$notify.error({title:"出现问题",message:t+"，"+e+'，参考<a target="_blank" href="https://github.com/ix64/unlock-music/wiki/使用提示">使用提示</a>',dangerouslyUseHTMLString:!0,duration:6e3}),window._paq.push(["trackEvent","Error",t,e]),console.error(t,e)},changePlaying(t){this.playing_url=t,this.playing_auto=!0},handleDeleteAll(){this.tableData.forEach(t=>{Y(t)}),this.tableData=[]},handleDownloadAll(){let t=0,e=setInterval(()=>{t<this.tableData.length?(K(this.tableData[t],this.download_format),t++):clearInterval(e)},300)}}},rt=at,nt=(a("034f"),Object(J["a"])(rt,q,R,!1,null,null,null)),ot=nt.exports,it=a("9483");Object(it["a"])("service-worker.js",{ready(){console.log("App is being served from cache by a service worker.")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available."),window.location.reload()},offline(){console.log("No internet connection found. App is running in offline mode.")},error(t){console.error("Error during service worker registration:",t)}}),F["default"].use(T.a),F["default"].use(P.a),F["default"].use(E.a),F["default"].use(S.a),F["default"].use(A.a),F["default"].use(M.a),F["default"].use(j.a),F["default"].use(k.a),F["default"].use(v.a),F["default"].use(w.a),F["default"].use(b.a),F["default"].use(h.a),F["default"].use(f.a),F["default"].use(u.a),F["default"].use(c.a),F["default"].use(i.a),F["default"].prototype.$notify=n.a,F["default"].config.productionTip=!1,document.getElementById("loader-source").remove(),new F["default"]({render:t=>t(ot)}).$mount("#app")},"85ec":function(t,e,a){},9224:function(t){t.exports=JSON.parse('{"name":"unlock-music","version":"1.5.2","updateInfo":"改善.mgg解锁算法","license":"MIT","description":"Unlock encrypted music file in browser.","repository":{"type":"git","url":"https://github.com/ix64/unlock-music"},"private":true,"scripts":{"serve":"vue-cli-service serve","build":"vue-cli-service build","fix-compatibility":"node ./src/fix-compatibility.js"},"dependencies":{"base64-js":"^1.3.1","browser-id3-writer":"^4.4.0","core-js":"^3.6.4","crypto-js":"^4.0.0","element-ui":"^2.13.0","iconv-lite":"^0.5.1","music-metadata-browser":"^2.0.5","register-service-worker":"^1.7.1","vue":"^2.6.11"},"devDependencies":{"@vue/cli-plugin-babel":"^4.3.0","@vue/cli-plugin-pwa":"^4.3.0","@vue/cli-service":"^4.3.0","babel-plugin-component":"^1.1.1","vue-cli-plugin-element":"^1.0.1","vue-template-compiler":"^2.6.11","workerize-loader":"^1.2.1"}}')},a8ee:function(t,e,a){"use strict";a.r(e),a.d(e,"Decrypt",(function(){return i}));a("e260"),a("ace4"),a("e6cf"),a("5cc6"),a("b39a");var r=a("fd2f"),n=a("06dc");const o=[0,0,0,32,102,116,121,112];async function i(t,e){const a=await Object(n["d"])(t),i=new Uint8Array(a);for(let r=0;r<8;++r)i[r]=o[r];const s=new Blob([i],{type:"audio/mp4"});return await Object(r["Decrypt"])(s,e,"m4a",!1)}},b57b:function(t,e,a){"use strict";a.r(e),a.d(e,"Decrypt",(function(){return s}));a("e260"),a("fb6a"),a("ace4"),a("e6cf"),a("25f0"),a("843c"),a("5cc6"),a("b39a"),a("ddb0"),a("2b3d");var r=a("06dc");const n=a("cb96"),o=[121,101,101,108,105,111,110,45,107,117,119,111,45,116,109,101],i="MoOtOiTvINGwd2E6n0E1i7L5t2IoOoNk";async function s(t,e,a){const i=new Uint8Array(await Object(r["d"])(t));if(!Object(r["h"])(o,i.slice(0,16)))return{status:!1,message:"Not a valid kwm file!"};let s=i.slice(24,32),l=c(s),u=i.slice(1024),d=u.length;for(let r=0;r<d;++r)u[r]^=l[r%32];const f=Object(r["b"])(u,"mp3"),m=r["a"][f];let h=new Blob([u],{type:m});const p=await n.parseBlob(h),b=Object(r["e"])(p.common.artist,p.common.title,e),g=Object(r["f"])(p);return{status:!0,title:b.title,artist:b.artist,ext:f,album:p.common.album,picture:g,file:URL.createObjectURL(h),mime:m}}function c(t){let e=new DataView(t.buffer),a=e.getBigUint64(0,!0).toString(),r=l(a),n=new Uint8Array(32);for(let o=0;o<32;o++)n[o]=i[o].charCodeAt()^r[o].charCodeAt();return n}function l(t){let e=t.length,a=t;return e>32?a=t.slice(0,32):e<32&&(a=t.padEnd(32,t)),a}},b6cf:function(t,e,a){"use strict";a.r(e),a.d(e,"Decrypt",(function(){return j}));a("e260"),a("fb6a"),a("ace4"),a("e6cf"),a("5cc6"),a("b39a"),a("ddb0"),a("2b3d");var r=a("06dc");a("26e9");const n=[79,103,103,83,0,2,0,0,0,0,0,0,0,0,255,255,255,255,0,0,0,0,255,255,255,255,1,30,1,118,111,114,98,105,115,0,0,0,0,2,68,172,0,0,0,0,0,0,0,238,2,0,0,0,0,0,184,1,79,103,103,83,0,0,0,0,0,0,0,0,0,0,255,255,255,255,1,0,0,0,255,255,255,255],o=[3,118,111,114,98,105,115,44,0,0,0,88,105,112,104,46,79,114,103,32,108,105,98,86,111,114,98,105,115,32,73,32,50,48,49,53,48,49,48,53,32,40,226,155,132,226,155,132,226,155,132,226,155,132,41,255,0,0,0,255,0,0,0,84,73,84,76,69,61],i=[9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,0,0,9,9,9,9,0,0,0,0,9,9,9,9,9,9,9,9,9,9,9,9,9,6,3,3,3,3,6,6,6,6,3,3,3,3,6,6,6,6,6,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,0,0,9,9,9,9,0,0,0,0],s=[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0,1,3,3,0,1,3,3,3,3,3,3,3,3],c=[222,81,250,195,74,214,202,144,126,103,94,247,213,82,132,216,71,149,187,161,170,198,102,35,146,98,243,116,161,159,244,160,29,63,91,240,19,14,9,61,249,188,0,17];class l{constructor(t,e,a){void 0===e||void 0===a?(44===t.length?(this.Matrix44=t,this.generateMask128from44()):(this.Matrix128=t,this.generateMask44from128()),this.generateMask58from128()):(this.Matrix58=t,this.Super58A=e,this.Super58B=a,this.generateMask128from58(),this.generateMask44from128())}generateMask128from58(){if(56!==this.Matrix58.length)throw"incorrect mask58 matrix length";let t=[];for(let e=0;e<8;e+=1)t=t.concat([this.Super58A],this.Matrix58.slice(7*e,7*e+7),[this.Super58B],this.Matrix58.slice(49-7*e,56-7*e).reverse());this.Matrix128=t}generateMask58from128(){if(128!==this.Matrix128.length)throw"incorrect mask128 length";const t=this.Matrix128[0],e=this.Matrix128[8];let a=[];for(let n=0;n<8;n+=1){let o=16*n,i=120-o;if(this.Matrix128[o]!==t||this.Matrix128[o+8]!==e)throw"decode mask-128 to mask-58 failed";let s=this.Matrix128.slice(o+1,o+8),c=this.Matrix128.slice(i+1,i+8).reverse();if(!Object(r["h"])(s,c))throw"decode mask-128 to mask-58 failed";a=a.concat(s)}this.Matrix58=a,this.Super58A=t,this.Super58B=e}generateMask44from128(){if(128!==this.Matrix128.length)throw"incorrect mask128 matrix length";let t=g();this.Matrix44=[];let e=0;t.forEach(t=>{let a=t.length;for(let e=1;e<a;e++)if(this.Matrix128[t[0]]!==this.Matrix128[t[e]])throw"decode mask-128 to mask-44 failed";this.Matrix44[e]=this.Matrix128[t[0]],e++})}generateMask128from44(){if(44!==this.Matrix44.length)throw"incorrect mask length";this.Matrix128=[];let t=0;g().forEach(e=>{e.forEach(e=>{this.Matrix128[e]=this.Matrix44[t]}),t++})}Decrypt(t){let e=t.slice(0),a=-1,r=-1;for(let n=0;n<t.length;n++)a++,r++,(32768===a||a>32768&&(a+1)%32768===0)&&(a++,r++),r>=128&&(r-=128),e[n]^=this.Matrix128[r];return e}}function u(){return new l(c)}function d(t){let e,a=Math.min(32768,t.length);for(let o=0;o<a;o+=128)try{if(e=new l(t.slice(o,o+128)),Object(r["h"])(r["c"],e.Decrypt(t.slice(0,r["c"].length))))break}catch(n){}return e}function f(t){if(t.length<256)return;let e={};for(let r=0;r<44;r++)e[r]={};const a=t[84]^t[12]^n[12],o=y(a),i=v(a);for(let r=0;r<o.length;r++){if(0===i[r])continue;let a=w(r),n=t[r]^o[r],s=i[r];n in e[a]?e[a][n]+=s:e[a][n]=s}let s=[];try{for(let t=0;t<44;t++)s[t]=h(e[t])}catch(d){return}const c=new l(s);let u=c.Decrypt(t.slice(0,r["i"].length));return Object(r["h"])(r["i"],u)?c:void 0}function m(t,e,a){return new l(t,e,a)}function h(t){if(0===t.length)throw"can not match at least one key";t.length>1&&console.warn("There are 2 potential value for the mask!");let e,a=0;for(let r in t)t[r]>a&&(e=r,a=t[r]);return parseInt(e)}const p=[],b=[];function g(){return p}function w(t){return b[t%128]}function y(t){let e=[t,255];for(let a=2;a<t;a++)e.push(255);return e.push(255),n.concat(e,o)}function v(t){let e=[6,0];for(let a=2;a<t;a++)e.push(4);return e.push(0),i.concat(e,s)}(function(){for(let e=0;e<128;e++){let t=(e*e+27)%256;t in p?p[t].push(e):p[t]=[e]}let t=0;p.forEach(e=>{e.forEach(e=>{b[e]=t}),t++})})();var _=a("1fb5");const k=a("cb96"),x={mgg:{handler:f,ext:"ogg",detect:!0},mflac:{handler:d,ext:"flac",detect:!0},qmc0:{handler:u,ext:"mp3",detect:!1},qmc2:{handler:u,ext:"ogg",detect:!1},qmc3:{handler:u,ext:"mp3",detect:!1},qmcogg:{handler:u,ext:"ogg",detect:!1},qmcflac:{handler:u,ext:"flac",detect:!1},bkcmp3:{handler:u,ext:"mp3",detect:!1},bkcflac:{handler:u,ext:"flac",detect:!1},tkm:{handler:u,ext:"m4a",detect:!1}};async function j(t,e,a){if(!(a in x))return{status:!1,message:"File type is incorrect!"};const n=x[a],o=new Uint8Array(await Object(r["d"])(t));let i,s,c;if(n.detect){const t=new DataView(o.slice(o.length-4).buffer).getUint32(0,!0),r=o.length-4-t;if(i=o.slice(0,r),s=n.handler(i),c=o.slice(r,r+t),void 0===s&&(s=await M(c,e,a)),void 0===s)return{status:!1,message:a+"格式仅提供实验性支持"}}else i=o,s=n.handler(i);let l=s.Decrypt(i);const u=Object(r["b"])(l,n.ext),d=r["a"][u];let f=new Blob([l],{type:d});const m=await k.parseBlob(f);for(let r in m.native)m.native[r].some(t=>"TCON"===t.id&&"(12)"===t.value)&&(m.common.artist=decode(m.common.artist,"gbk"),m.common.title=decode(m.common.title,"gbk"),m.common.album=decode(m.common.album,"gbk"));const h=Object(r["e"])(m.common.artist,m.common.title,e);n.detect&&O(c,s.Matrix128,h.artist,h.title,m.common.album,e,a);let p=Object(r["f"])(m);return""===p&&(p=await D(h.artist,h.title,m.common.album)),{status:!0,title:h.title,artist:h.artist,ext:u,album:m.common.album,picture:p,file:URL.createObjectURL(f),mime:d}}function O(t,e,a,r,n,o,i){fetch("https://stats.ixarea.com/collect/qmcmask/usage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({Mask:Object(_["fromByteArray"])(new Uint8Array(e)),Key:Object(_["fromByteArray"])(t),Artist:a,Title:r,Album:n,Filename:o,Format:i})}).then().catch()}async function M(t,e,a){try{const r=await fetch("https://stats.ixarea.com/collect/qmcmask/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({Format:a,Key:Object(_["fromByteArray"])(t),Filename:e,Type:44})});let n=await r.json();return m(Object(_["toByteArray"])(n.Matrix44))}catch(r){console.log(r)}}async function D(t,e,a){let n,o="https://c.y.qq.com/soso/fcgi-bin/client_search_cp?n=10&new_json=1&w="+encodeURIComponent(t+" "+e+" "+a),i=void 0;try{n=await Object(r["j"])(o,"callback"),i=n["data"]["song"]["list"][0]}catch(c){}let s="";return i&&i["album"]&&(void 0!==i["album"]["pmid"]?s="https://y.gtimg.cn/music/photo_new/T002M000"+i["album"]["pmid"]+".jpg":void 0!==i["album"]["id"]&&(s="https://imgcache.qq.com/music/photo/album/"+i["album"]["id"]%100+"/albumpic_"+i["album"]["id"]+"_0.jpg")),s}},bd2e:function(t,e,a){"use strict";a.r(e),a.d(e,"CommonDecrypt",(function(){return l}));a("baa5"),a("e6cf");const r=a("dde9"),n=a("b57b"),o=a("002f"),i=a("b6cf"),s=a("fd2f"),c=a("a8ee");async function l(t){let e,a=t.name.substring(t.name.lastIndexOf(".")+1,t.name.length).toLowerCase(),l=t.name.substring(0,t.name.lastIndexOf("."));switch(a){case"ncm":e=await r.Decrypt(t.raw,l,a);break;case"kwm":e=await n.Decrypt(t.raw,l,a);break;case"xm":case"wav":case"mp3":case"flac":case"m4a":e=await o.Decrypt(t.raw,l,a);break;case"ogg":e=await s.Decrypt(t.raw,l,a);break;case"tm0":case"tm3":e=await s.Decrypt(t.raw,l,"mp3");break;case"qmc3":case"qmc2":case"qmc0":case"qmcflac":case"qmcogg":case"tkm":case"bkcmp3":case"bkcflac":case"mflac":case"mgg":e=await i.Decrypt(t.raw,l,a);break;case"tm2":case"tm6":e=await c.Decrypt(t.raw,l);break;default:e={status:!1,message:"不支持此文件格式"}}return e.rawExt||(e.rawExt=a),e.rawFilename||(e.rawFilename=l),e}},bfa2:function(t,e,a){var r=a("3d67"),n=["CommonDecrypt"];t.exports=function(){var t=new Worker(a.p+"8613dc4a154ff52d48f0.worker.js",{name:"[hash].worker.js"});return r(t,n),t}},dde9:function(t,e,a){"use strict";a.r(e),a.d(e,"Decrypt",(function(){return c}));a("c975"),a("e260"),a("fb6a"),a("ace4"),a("e6cf"),a("25f0"),a("5319"),a("5cc6"),a("b39a"),a("ddb0"),a("2b3d");var r=a("06dc");const n=a("3452"),o=n.enc.Hex.parse("687a4852416d736f356b496e62617857"),i=n.enc.Hex.parse("2331346C6A6B5F215C5D2630553C2728"),s=[67,84,69,78,70,68,65,77];async function c(t,e,a){const n=await Object(r["d"])(t),o=new DataView(n);if(!Object(r["h"])(s,new Uint8Array(n,0,8)))return{status:!1,message:"此ncm文件已损坏"};const i=l(o,n,10),c=u(i.data),f=d(o,n,i.offset),m=f.data;let h=f.offset+o.getUint32(f.offset+5,!0)+13,p=new Uint8Array(n,h),b=p.length;for(let r=0;r<b;++r)p[r]^=c[255&r];void 0===m.album&&(m.album="");const g=[];m.artist&&m.artist.forEach(t=>g.push(t[0]));const w=Object(r["e"])(g.join(" & "),m.musicName,e);0===g.length&&g.push(w.artist),void 0===m.format&&(m.format=Object(r["b"])(p,"mp3"));const y=await Object(r["g"])(m.albumPic);"mp3"===m.format&&(p=await Object(r["k"])(p,g,w.title,m.album,y.buffer,m.albumPic));const v=r["a"][m.format],_=new Blob([p],{type:v});return{status:!0,title:w.title,artist:w.artist,ext:m.format,album:m.album,picture:y.url,file:URL.createObjectURL(_),mime:v}}function l(t,e,a){const r=t.getUint32(a,!0);a+=4;const i=new Uint8Array(e,a,r).map(t=>100^t);a+=r;const s=n.AES.decrypt({ciphertext:n.lib.WordArray.create(i)},o,{mode:n.mode.ECB,padding:n.pad.Pkcs7}),c=new Uint8Array(s.sigBytes),l=s.words,u=s.sigBytes;for(let n=0;n<u;n++)c[n]=l[n>>>2]>>>24-n%4*8&255;return{offset:a,data:c.slice(17)}}function u(t){const e=new Uint8Array(Array(256).keys()),a=t.length;let r=0;for(let n=0;n<256;n++)r=e[n]+r+t[n%a]&255,[e[n],e[r]]=[e[r],e[n]];return e.map((t,e,a)=>{e=e+1&255;const r=a[e],n=a[e+r&255];return a[r+n&255]})}function d(t,e,a){const r=t.getUint32(a,!0);if(a+=4,0===r)return{data:{},offset:a};const o=new Uint8Array(e,a,r).map(t=>99^t);a+=r;const s=n.AES.decrypt({ciphertext:n.enc.Base64.parse(n.lib.WordArray.create(o.slice(22)).toString(n.enc.Utf8))},i,{mode:n.mode.ECB,padding:n.pad.Pkcs7}).toString(n.enc.Utf8),c=s.indexOf(":");let l=JSON.parse(s.slice(c+1));return"dj"===s.slice(0,c)&&(l=l.mainMusic),l.albumPic&&(l.albumPic=l.albumPic.replace("http://","https://")),{data:l,offset:a}}},f1ab:function(t,e,a){"use strict";var r=a("fae0"),n=a.n(r);n.a},fae0:function(t,e,a){},fd2f:function(t,e,a){"use strict";a.r(e),a.d(e,"Decrypt",(function(){return o}));a("e260"),a("ace4"),a("e6cf"),a("5cc6"),a("b39a"),a("ddb0"),a("2b3d");var r=a("06dc");const n=a("cb96");async function o(t,e,a,o=!0){let i=a;if(o){const e=new Uint8Array(await Object(r["d"])(t));i=Object(r["b"])(e,a),i!==a&&(t=new Blob([e],{type:r["a"][i]}))}const s=await n.parseBlob(t),c=Object(r["e"])(s.common.artist,s.common.title,e);return{status:!0,title:c.title,artist:c.artist,ext:i,album:s.common.album,picture:Object(r["f"])(s),file:URL.createObjectURL(t),mime:r["a"][i]}}}});